{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getProductionDslName = exports.isBranchingProd = exports.isOptionalProd = exports.isSequenceProd = void 0;\n\nvar some_1 = __importDefault(require(\"lodash/some\"));\n\nvar every_1 = __importDefault(require(\"lodash/every\"));\n\nvar includes_1 = __importDefault(require(\"lodash/includes\"));\n\nvar model_1 = require(\"./model\");\n\nfunction isSequenceProd(prod) {\n  return prod instanceof model_1.Alternative || prod instanceof model_1.Option || prod instanceof model_1.Repetition || prod instanceof model_1.RepetitionMandatory || prod instanceof model_1.RepetitionMandatoryWithSeparator || prod instanceof model_1.RepetitionWithSeparator || prod instanceof model_1.Terminal || prod instanceof model_1.Rule;\n}\n\nexports.isSequenceProd = isSequenceProd;\n\nfunction isOptionalProd(prod, alreadyVisited) {\n  if (alreadyVisited === void 0) {\n    alreadyVisited = [];\n  }\n\n  var isDirectlyOptional = prod instanceof model_1.Option || prod instanceof model_1.Repetition || prod instanceof model_1.RepetitionWithSeparator;\n\n  if (isDirectlyOptional) {\n    return true;\n  } // note that this can cause infinite loop if one optional empty TOP production has a cyclic dependency with another\n  // empty optional top rule\n  // may be indirectly optional ((A?B?C?) | (D?E?F?))\n\n\n  if (prod instanceof model_1.Alternation) {\n    // for OR its enough for just one of the alternatives to be optional\n    return (0, some_1.default)(prod.definition, function (subProd) {\n      return isOptionalProd(subProd, alreadyVisited);\n    });\n  } else if (prod instanceof model_1.NonTerminal && (0, includes_1.default)(alreadyVisited, prod)) {\n    // avoiding stack overflow due to infinite recursion\n    return false;\n  } else if (prod instanceof model_1.AbstractProduction) {\n    if (prod instanceof model_1.NonTerminal) {\n      alreadyVisited.push(prod);\n    }\n\n    return (0, every_1.default)(prod.definition, function (subProd) {\n      return isOptionalProd(subProd, alreadyVisited);\n    });\n  } else {\n    return false;\n  }\n}\n\nexports.isOptionalProd = isOptionalProd;\n\nfunction isBranchingProd(prod) {\n  return prod instanceof model_1.Alternation;\n}\n\nexports.isBranchingProd = isBranchingProd;\n\nfunction getProductionDslName(prod) {\n  /* istanbul ignore else */\n  if (prod instanceof model_1.NonTerminal) {\n    return \"SUBRULE\";\n  } else if (prod instanceof model_1.Option) {\n    return \"OPTION\";\n  } else if (prod instanceof model_1.Alternation) {\n    return \"OR\";\n  } else if (prod instanceof model_1.RepetitionMandatory) {\n    return \"AT_LEAST_ONE\";\n  } else if (prod instanceof model_1.RepetitionMandatoryWithSeparator) {\n    return \"AT_LEAST_ONE_SEP\";\n  } else if (prod instanceof model_1.RepetitionWithSeparator) {\n    return \"MANY_SEP\";\n  } else if (prod instanceof model_1.Repetition) {\n    return \"MANY\";\n  } else if (prod instanceof model_1.Terminal) {\n    return \"CONSUME\";\n  } else {\n    throw Error(\"non exhaustive match\");\n  }\n}\n\nexports.getProductionDslName = getProductionDslName;","map":{"version":3,"sources":["../../src/helpers.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getProductionDslName = exports.isBranchingProd = exports.isOptionalProd = exports.isSequenceProd = void 0;\nvar some_1 = __importDefault(require(\"lodash/some\"));\nvar every_1 = __importDefault(require(\"lodash/every\"));\nvar includes_1 = __importDefault(require(\"lodash/includes\"));\nvar model_1 = require(\"./model\");\nfunction isSequenceProd(prod) {\n    return (prod instanceof model_1.Alternative ||\n        prod instanceof model_1.Option ||\n        prod instanceof model_1.Repetition ||\n        prod instanceof model_1.RepetitionMandatory ||\n        prod instanceof model_1.RepetitionMandatoryWithSeparator ||\n        prod instanceof model_1.RepetitionWithSeparator ||\n        prod instanceof model_1.Terminal ||\n        prod instanceof model_1.Rule);\n}\nexports.isSequenceProd = isSequenceProd;\nfunction isOptionalProd(prod, alreadyVisited) {\n    if (alreadyVisited === void 0) { alreadyVisited = []; }\n    var isDirectlyOptional = prod instanceof model_1.Option ||\n        prod instanceof model_1.Repetition ||\n        prod instanceof model_1.RepetitionWithSeparator;\n    if (isDirectlyOptional) {\n        return true;\n    }\n    // note that this can cause infinite loop if one optional empty TOP production has a cyclic dependency with another\n    // empty optional top rule\n    // may be indirectly optional ((A?B?C?) | (D?E?F?))\n    if (prod instanceof model_1.Alternation) {\n        // for OR its enough for just one of the alternatives to be optional\n        return (0, some_1.default)(prod.definition, function (subProd) {\n            return isOptionalProd(subProd, alreadyVisited);\n        });\n    }\n    else if (prod instanceof model_1.NonTerminal && (0, includes_1.default)(alreadyVisited, prod)) {\n        // avoiding stack overflow due to infinite recursion\n        return false;\n    }\n    else if (prod instanceof model_1.AbstractProduction) {\n        if (prod instanceof model_1.NonTerminal) {\n            alreadyVisited.push(prod);\n        }\n        return (0, every_1.default)(prod.definition, function (subProd) {\n            return isOptionalProd(subProd, alreadyVisited);\n        });\n    }\n    else {\n        return false;\n    }\n}\nexports.isOptionalProd = isOptionalProd;\nfunction isBranchingProd(prod) {\n    return prod instanceof model_1.Alternation;\n}\nexports.isBranchingProd = isBranchingProd;\nfunction getProductionDslName(prod) {\n    /* istanbul ignore else */\n    if (prod instanceof model_1.NonTerminal) {\n        return \"SUBRULE\";\n    }\n    else if (prod instanceof model_1.Option) {\n        return \"OPTION\";\n    }\n    else if (prod instanceof model_1.Alternation) {\n        return \"OR\";\n    }\n    else if (prod instanceof model_1.RepetitionMandatory) {\n        return \"AT_LEAST_ONE\";\n    }\n    else if (prod instanceof model_1.RepetitionMandatoryWithSeparator) {\n        return \"AT_LEAST_ONE_SEP\";\n    }\n    else if (prod instanceof model_1.RepetitionWithSeparator) {\n        return \"MANY_SEP\";\n    }\n    else if (prod instanceof model_1.Repetition) {\n        return \"MANY\";\n    }\n    else if (prod instanceof model_1.Terminal) {\n        return \"CONSUME\";\n    }\n    else {\n        throw Error(\"non exhaustive match\");\n    }\n}\nexports.getProductionDslName = getProductionDslName;\n//# sourceMappingURL=helpers.js.map"]},"metadata":{},"sourceType":"script"}